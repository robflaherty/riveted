<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link href="./favicon.ico" rel="shortcut icon">

  <title>Riveted - A Google Analytics plugin for measuring active time on site</title>

  <link href="css/normalize.css" rel="stylesheet" />
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Righteous' rel='stylesheet' type='text/css'>
  <link href="css/prism.css" rel="stylesheet" />
  <link href="css/styles.css" rel="stylesheet" />

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga_test');

    ga_test('create', 'UA-1413210-12', 'auto');
    ga_test('send', 'pageview');
  </script>

</head>
<body>
  <div id="pre">
    You might also like my other analytics plugins, <strong><a href="http://scrolldepth.parsnip.io">Scroll Depth</a></strong> and <strong><a href="http://screentime.parsnip.io">Screentime</a></strong>.
  </div>
  <div class="wrap">
  <div id="content">
  <h1>Riveted</h1>
  <h2>A Google Analytics plugin for measuring active time on site</h2>

  <p>Google Analytics does a lot of things really well but the way it measures visit duration—by calculating the time difference between pageviews—provides only a partial view of how much time is actually spent on site.</p>

  <p>Riveted helps fix this by measuring the amount of time users are actively engaged (e.g., clicking, scrolling, using the keyboard) and then reporting the data to Google Analytics in frequent intervals.
  </p>

  <p>It supports Universal Analytics, Classic Google Analytics, and Google Tag Manager. It can also be used with any analytics tool that supports events, e.g. Mixpanel or Keen.io.</p>

<p class="buttons">
  <a href="https://raw.github.com/robflaherty/riveted/master/riveted.min.js" target="_blank" class="button button-download">Download the JS (2 kb)</a>
  <a href="http://wordpress.org/plugins/riveted/" target="_blank" class="button">Get the WordPress Plugin</a>
</p>

<h2>Details</h2>

 <p>The plugin listens for mouse movements, clicks, scrolling, and keyboard activity to define an active user. It also checks whether the tab is currently visible.</p>

 <p>Every 5 seconds it check if the user is active and pings Google Analytics. If the user goes 30 seconds without registering an action the user is considered idle.</p>

 <p>You'll find the data in the dashboard under Events > Riveted. Each Event Label represents a duration of seconds. The Event Value shows the total number of seconds. Giving each tick of the clock its own label like this allows you to use Advanced Segments to create segments based on engagement time.</p>

  <p>The first interaction also triggers a User Timing Event, which allows you to measure the number of milliseconds from the pageload to the user's first action.</p>

  <p>Here's a blog post with tips on <a href="https://medium.com/google-analytics/84d9981920da">how to use the data Riveted collects</a>.</p>

  <p>Depending on your volume of traffic you may need to increase the reporting interval (see Google's <a href="https://developers.google.com/analytics/devguides/collection/gajs/limits-quotas" target="_blank">collection quotas</a>).</p>

<h2>Using it</h2>

<p>After your Google Analytics tracking code, load the script and call the riveted.init() function, like this:</p>

<pre><code class="language-javascript">&lt;script src="riveted.min.js"&gt;&lt;/script&gt;
&lt;script&gt;riveted.init();&lt;/script&gt;</code>
</pre>

<h2>Plugin options</h2>

<h3>reportInterval</h3>
<p>This number, in seconds, determines both the increment of reporting and the frequency of pinging. The default is 5 seconds.</p>

<h3>idleTimeout</h3>
<p>This number determines how long a user can go without triggering an event before we consider them inactive. The default is 30 seconds.</p>

<h3>nonInteraction</h3>
<p>By default, GA Events are sent with the Non-interaction option set to true. This keeps the event from impacting the bounce rate and visit duration. <strong>Caution</strong>: If you set this to false, the bounce rate will drop to near zero and the visit duration may leap. Make sure you know what you're doing before using this option.</p>

<h3>gaGlobal</h3>
<p>If you're using Universal Analytics this lets you set a custom name for the GA global object. You may need this option if you're using Yoast's analytics plugin, which changes the GA global name to <code>__gaTracker</code>.</p>

<h3>gaTracker</h3>
<p>If you're using Universal Analytics and tracking multiple properties on the same page, this option lets you specify which property Riveted should send data to.</p>

<pre><code class="language-javascript">// Example with options
riveted.init({
  reportInterval: 10,   // Default: 5
  idleTimeout: 20,      // Default: 30
  nonInteraction: true  // Default: true
});</code></pre>

<h2>Non-Google Analytics Use</h2>
<p>With a simple callback you can use Riveted with any analytics service that supports events.</p>

<h3>eventHandler</h3>
<p>The eventHandler callback receives one argument, which is the current tally of engaged time, in seconds. This fires at whatever interval is specified in the reportInterval option. Note: this option is not yet available in the WordPress plugin.</p>

<pre><code class="language-javascript">// Example using Keen.io
riveted.init({
  eventHandler: function(data) {
    Keen.addEvent("Riveted", data);
  }
});</code></pre>

<h3>userTimingHandler</h3>
<p>There's also a custom event handler for the timing event. This fires only once and records the length of time (in milliseconds) from the initial page load to the first activity event.</p>

<h2>Methods</h2>
<p>There are some methods for interacting directly with the Riveted timer.</p>

<h3>riveted.trigger()</h3>
<p>Calling this method restarts the Idle timer. One use for this would be to keep the Riveted timer running while the user watches a video.</p>

<h3>riveted.setIdle()</h3>
<p>This method stops the timer and sets the user to the Idle state. Any user action will reactivate it.</p>

<h3>riveted.reset()</h3>
<p>This method resets the clock. This is useful for asynchronous page navigation where you want to reset the page context client-side.</p>

<h3>riveted.off()</h3>
<p>This method completely turns the plugin off.</p>

<h3>riveted.on()</h3>
<p>If you've turned off the plugin with the riveted.off() method, this method will turn it back on.</p>

<h2>Google Tag Manager</h2>
<p>If you want to integrate with Google Tag Manager, here are the dataLayer variable names:</p>
<ul>
<li>Riveted Event Name = Riveted</li>
<li>Riveted Timing Event Name = RivetedTiming</li>
<li>Event Category = {{eventCategory}}</li>
<li>Event Action = {{eventAction}}</li>
<li>Event Label = {{eventLabel}}</li>
<li>Event Value = {{eventValue}}</li>
<li>Event Non-Interaction = {{eventNonInteraction}}</li>
</ul>
<h2>Browser Support</h2>

<p>Tested in latest versions of Chrome, Firefox, Safari, and Opera. Internet Explorer 8-11. iOS and Android.</p>

<h2>Github</h2>
<p class="github"><a href="https://github.com/robflaherty/riveted" target="_blank" class="button">View on Github</a></p>

</div>
</div>
<div id="bottom">
<div class="inner">

  <h2>Contact</h2>

  <p>
    <a href="https://twitter.com/robflaherty" target="_blank" class="button button-twitter">@robflaherty</a>
    <a href="http://parsnip.io" class="button">parsnip.io</a>
  </p>


  <h2>License</h2>

  <p style="margin: 0;">Licensed under the MIT license.</p>

</div>
</div>
<script src="js/prism.js"></script>
<script src="js/riveted.min.js"></script>
<script>
  riveted.init({
    gaGlobal: 'ga_test'
  });
</script>

</body>
</html>
